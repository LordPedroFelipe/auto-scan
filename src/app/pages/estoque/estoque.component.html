<div class="container">
    <h2>Estoque da Loja</h2>

    <div class="actions">
        <button 
            mat-flat-button color="primary"
            (click)="abrirCadastro()">
                Cadastrar Veículo
            </button>
    </div>

    <mat-accordion>
        <mat-expansion-panel>
            <mat-expansion-panel-header>
            <mat-panel-title>
                Filtros Avançados
            </mat-panel-title>
            <mat-panel-description>
                (opcional)
            </mat-panel-description>
            </mat-expansion-panel-header>

            <form [formGroup]="filtroForm" (ngSubmit)="aplicarFiltros()">
            <div class="filtros-grid">

                <mat-form-field appearance="fill">
                <mat-label>Marca</mat-label>
                <input matInput formControlName="brand" />
                </mat-form-field>

                <mat-form-field appearance="fill">
                <mat-label>Modelo</mat-label>
                <input matInput formControlName="model" />
                </mat-form-field>

                <mat-form-field appearance="fill">
                <mat-label>Ano</mat-label>
                <input matInput type="number" formControlName="year" />
                </mat-form-field>

                <mat-form-field appearance="fill">
                <mat-label>Cor</mat-label>
                <input matInput formControlName="color" />
                </mat-form-field>

                <mat-form-field appearance="fill">
                <mat-label>Câmbio</mat-label>
                <mat-select formControlName="transmission">
                    <mat-option value="">Todos</mat-option>
                    <mat-option value="Automático">Automático</mat-option>
                    <mat-option value="Manual">Manual</mat-option>
                </mat-select>
                </mat-form-field>

                <mat-form-field appearance="fill">
                <mat-label>Combustível</mat-label>
                <mat-select formControlName="fuelType">
                    <mat-option value="">Todos</mat-option>
                    <mat-option value="Gasolina">Gasolina</mat-option>
                    <mat-option value="Flex">Flex</mat-option>
                    <mat-option value="Diesel">Diesel</mat-option>
                    <mat-option value="Elétrico">Elétrico</mat-option>
                </mat-select>
                </mat-form-field>

                <mat-checkbox formControlName="hasAuction">Leilão</mat-checkbox>
                <mat-checkbox formControlName="hasAccident">Sinistro</mat-checkbox>
                <mat-checkbox formControlName="isFirstOwner">1º dono</mat-checkbox>
                <mat-checkbox formControlName="isOnOffer">Em oferta</mat-checkbox>

            </div>

            <div class="filtros-acoes">
                <button mat-flat-button color="primary" type="submit">Aplicar Filtros</button>
                <button mat-stroked-button type="button" (click)="limparFiltros()">Limpar</button>
            </div>
            </form>
        </mat-expansion-panel>
    </mat-accordion>

    <div class="cards-container">
  <mat-card class="card-veiculo" *ngFor="let v of veiculos">
    <div class="card-topo">
      <img *ngIf="v.mainPhotoUrl" [src]="v.mainPhotoUrl" [alt]="v.brand + ' ' + v.model" />
    </div>

    <mat-card-content>
      <h3>{{ v.brand }} {{ v.model }} {{ v.year }}</h3>
      <p><strong>Cor:</strong> {{ v.color }}</p>
      <p><strong>KM:</strong> {{ v.mileage | number }} km</p>
      <p><strong>Preço:</strong> R$ {{ v.price | number: '1.0-0' }}</p>
    </mat-card-content>

    <mat-card-actions align="end">
      <button mat-raised-button color="primary"  (click)="abrirDetalhes(v)">Detalhes</button>
    </mat-card-actions>
  </mat-card>
</div>


  <!--mat-table [dataSource]="veiculos" class="mat-elevation-z4">
    <ng-container matColumnDef="foto">
    <mat-header-cell *matHeaderCellDef>Foto</mat-header-cell>
    <mat-cell *matCellDef="let v">
        <img *ngIf="v.mainPhotoUrl" [src]="v.mainPhotoUrl" alt="{{ v.brand }} {{ v.model }}" class="thumb-carro" />
    </mat-cell>
    </ng-container>

    <ng-container matColumnDef="brand">
      <mat-header-cell *matHeaderCellDef>Marca</mat-header-cell>
      <mat-cell *matCellDef="let v">{{ v.brand }}</mat-cell>
    </ng-container>

    <ng-container matColumnDef="model">
      <mat-header-cell *matHeaderCellDef>Modelo</mat-header-cell>
      <mat-cell *matCellDef="let v">{{ v.model }}</mat-cell>
    </ng-container>

    <ng-container matColumnDef="year">
      <mat-header-cell *matHeaderCellDef>Ano</mat-header-cell>
      <mat-cell *matCellDef="let v">{{ v.year }}</mat-cell>
    </ng-container>

    <ng-container matColumnDef="price">
      <mat-header-cell *matHeaderCellDef>Preço</mat-header-cell>
      <mat-cell *matCellDef="let v">R$ {{ v.price | number: '1.0-0' }}</mat-cell>
    </ng-container>

    <ng-container matColumnDef="mileage">
      <mat-header-cell *matHeaderCellDef>KM</mat-header-cell>
      <mat-cell *matCellDef="let v">{{ v.mileage | number }}</mat-cell>
    </ng-container>

    <ng-container matColumnDef="color">
      <mat-header-cell *matHeaderCellDef>Cor</mat-header-cell>
      <mat-cell *matCellDef="let v">{{ v.color }}</mat-cell>
    </ng-container>

    <ng-container matColumnDef="acoes">
      <mat-header-cell *matHeaderCellDef>Ações</mat-header-cell>
      <mat-cell *matCellDef="let v">
        <button mat-icon-button color="primary" (click)="abrirDetalhes(v)" matTooltip="Detalhes">
          <mat-icon>visibility</mat-icon>
        </button>
        <button mat-icon-button color="accent" (click)="abrirCadastro(v)" matTooltip="Editar">
          <mat-icon>edit</mat-icon>
        </button>
        <button mat-icon-button color="warn" (click)="excluir(v.id)" matTooltip="Excluir">
          <mat-icon>delete</mat-icon>
        </button>
      </mat-cell>
    </ng-container>

    <mat-header-row *matHeaderRowDef="displayedColumns"></mat-header-row>
    <mat-row *matRowDef="let row; columns: displayedColumns;"></mat-row>
  </mat-table-->

  <!-- Paginação -->
  <mat-paginator
    [length]="totalCount"
    [pageSize]="pageSize"
    [pageIndex]="pageIndex"
    [pageSizeOptions]="[5, 10, 20]"
    (page)="mudarPagina($event)">
  </mat-paginator>
</div>
